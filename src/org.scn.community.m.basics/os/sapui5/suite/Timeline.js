/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2013 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.suite.ui.commons.Timeline");jQuery.sap.require("sap.suite.ui.commons.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.suite.ui.commons.Timeline",{metadata:{publicMethods:["getCurrentFilter","setCurrentFilter","setSuspendSocialFeature","getSuspendSocailFeature","setCustomMessage","getHeaderBar","getMessageStrip"],library:"sap.suite.ui.commons",properties:{"data":{type:"object",group:"Misc",defaultValue:null},"sortOldestFirst":{type:"boolean",group:"Misc",defaultValue:false},"axisOrientation":{type:"sap.suite.ui.commons.TimelineAxisOrientation",group:"Misc",defaultValue:sap.suite.ui.commons.TimelineAxisOrientation.Vertical},"alignment":{type:"sap.suite.ui.commons.TimelineAlignment",group:"Misc",defaultValue:sap.suite.ui.commons.TimelineAlignment.Right},"showIcons":{type:"boolean",group:"Misc",defaultValue:true},"noDataText":{type:"string",group:"Misc",defaultValue:null},"width":{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:'100%'},"enableBusyIndicator":{type:"boolean",group:"Misc",defaultValue:true},"showHeaderBar":{type:"boolean",group:"Misc",defaultValue:true},"growing":{type:"boolean",group:"Misc",defaultValue:true},"growingThreshold":{type:"int",group:"Misc",defaultValue:5},"visible":{type:"boolean",group:"Appearance",defaultValue:true},"enableBackendFilter":{type:"boolean",group:"",defaultValue:false},"enableAllInFilterItem":{type:"boolean",group:"Behavior",defaultValue:true},"enableSocial":{type:"boolean",group:"Misc",defaultValue:false},"showSuggestion":{type:"boolean",group:"Behavior",defaultValue:true},"enableScroll":{type:"boolean",group:"Misc",defaultValue:true},"forceGrowing":{type:"boolean",group:"Misc",defaultValue:false},"sort":{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{"content":{type:"sap.suite.ui.commons.TimelineItem",multiple:true,singularName:"content"},"filterList":{type:"sap.suite.ui.commons.TimelineFilterListItem",multiple:true,singularName:"filterList"},"suggestionItems":{type:"sap.m.StandardListItem",multiple:true,singularName:"suggestionItem"},"customFilter":{type:"sap.ui.core.Control",multiple:false}},events:{"filterSelectionChange":{},"select":{},"addPost":{},"suggest":{},"suggestionItemSelected":{},"grow":{},"filterOpen":{}}}});sap.suite.ui.commons.Timeline.M_EVENTS={'filterSelectionChange':'filterSelectionChange','select':'select','addPost':'addPost','suggest':'suggest','suggestionItemSelected':'suggestionItemSelected','grow':'grow','filterOpen':'filterOpen'};jQuery.sap.require("sap.m.library");jQuery.sap.require("sap.ui.core.IconPool");jQuery.sap.require("sap.ui.core.Icon");jQuery.sap.require("sap.ui.core.delegate.ItemNavigation");jQuery.sap.require("sap.suite.ui.commons.TimelineFilterListItem");jQuery.sap.require("sap.ui.core.ResizeHandler");jQuery.sap.require("sap.ui.Device");sap.suite.ui.commons.Timeline.INTERNAL_MODEL_NAME="sapsuiteuicommonsTimelineInternalModel";
sap.suite.ui.commons.Timeline.prototype.init=function(){this.data("sap-ui-fastnavgroup","true",true);this._previousTarget=null;this._previousTabPreviousTarget=null;this._filterTarget=null;this._addTarget=null;this._shell=null;this._aRows=null;this._aDomRefs=null;this._messageStrip=null;this._sapTabbable=null;this._moreButtonFound=false;this._pageSize=10;this._addButtonFound=false;this._dummy=false;this._tabprevious=false;this._tabnext=false;this._moreTarget=null;this._saveTarget=null;this._previousShellTarget=null;this._previousLineItemsHeight=0;this._showMorescrollLocation=0;this._skipOnFocusIn=false;this._previousShiftF6Target=null;this._outFocusTarget=null;this._outFocusTargetClassName=null;this._firstTimeSetFocus=true;this._headerBarFieldLength=0;sap.m.DisplayListItem.extend("sap.suite.ui.commons.DisplayListItemWithKey",{metadata:{properties:{"key":{type:"string",defaultValue:""},}},renderer:'sap.m.DisplayListItemRenderer'});var t=this;this._prevTargetId="";this._internalModel=new sap.ui.model.json.JSONModel();this._finishLoading=true;this.setModel(this._internalModel,sap.suite.ui.commons.Timeline.INTERNAL_MODEL_NAME);var l=sap.ui.getCore().getConfiguration().getLanguage();this.resBundle=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons",l);this._emptyList=new sap.m.List();this._emptyList.setNoDataText(this.resBundle.getText('TIMELINE_NO_DATA'));this._filterIcon=new sap.m.Button(this.getId()+"-filter",{type:sap.m.ButtonType.Transparent,icon:"sap-icon://filter",tooltip:this.resBundle.getText("TIMELINE_FILTER_BY"),press:function(e){t._openFilterDialog();}});var T=new sap.m.ToolbarSpacer();this._headerBar=new sap.m.Toolbar({id:this.getId()+"-filterToolBar",content:[T,this._filterIcon]});var t=this;this._messageStrip=new sap.m.MessageStrip({close:function(e){this.setText("");if(t._lastHeaderBaRTabField!==null){jQuery(t._lastHeaderBaRTabField).focus();e.preventDefault();}}});this._filterInfoText=new sap.m.Text({maxLines:1,width:"100%"});this._headerInfoBar=new sap.m.Toolbar({id:this.getId()+"-filterInfoBar",content:[this._filterInfoText],design:sap.m.ToolbarDesign.Info,visible:false});this._customFilter=false;this._filterChange=false;this._contentChange=true;this._filterDialog=new sap.m.ResponsivePopover(this.getId()+"-popover_filter",{title:this.resBundle.getText("TIMELINE_FILTER_BY"),placement:sap.m.PlacementType.Auto,contentHeight:"15rem",contentWidth:"15rem"});var d=new sap.suite.ui.commons.DisplayListItemWithKey({key:"{key}",label:"{text}"});this._filterList=new sap.m.List(this.getId()+"-filterlist",{mode:sap.m.ListMode.SingleSelectMaster,items:{path:"/items",template:d},selectionChange:function(e){var f=t._filterList.getSelectedItem().getLabel();t._setFilterInfoText(f);if(t._filterList.getSelectedItem()&&!t.getEnableBackendFilter()){t._filterChange=true;t._filterText=f;t._resetDisplayItems(f);}t.fireFilterSelectionChange({selectedItem:t._filterList.getSelectedItem()});t._currentFilterKey=t._filterList.getSelectedItem().getKey();t._filterDialog.close();}});this._filterText=this.resBundle.getText("TIMELINE_ALL");this._growing=false;if(this.getGrowing()){this._growDisplayCount=this.getGrowingThreshold();this._iItemCount=this.getGrowingThreshold();this._getMoreButton=new sap.m.Button(this.getId()+"-getmore",{text:this.resBundle.getText("TIMELINE_SHOW_MORE"),width:"100%",press:function(){if(document.getElementById(t.getId()+'-contentH')){t._showMorescrollLocation=document.getElementById(t.getId()+'-contentH').scrollLeft;}else{t._showMorescrollLocation=document.getElementById(t.getId()+'-content').scrollTop;}t.fireGrow();t._iItemCount+=t.getGrowingThreshold();var o=t._growDisplayCount;t._growDisplayCount+=t.getGrowingThreshold();if(t.oItemNavigation){t.removeDelegate(t.oItemNavigation);t.oItemNavigation.destroy();}t._startItemNavigation();if(t._iItemCount>t.getMaxItemsCount()){t._iItemCount=t.getMaxItemsCount();}var b=t.getBindingInfo("content");if(t._growing){b.startIndex=0;b.length=t._iItemCount;t.getBinding("content").getContexts(0,t._iItemCount);}else{t.rerender();}jQuery.sap.delayedCall(300,t,function(){if(document.getElementById(t.getId()+'-contentH')){document.getElementById(t.getId()+'-contentH').scrollLeft=t._showMorescrollLocation;}else{document.getElementById(t.getId()+'-content').scrollTop=t._showMorescrollLocation;}});}});}this._scHeight=400;this._height=0;this._aFilterList=[];};
sap.suite.ui.commons.Timeline.prototype._createAddDialog=function(){var t=this;this._addDialog=new sap.m.Popover(this.getId()+"-popover_add",{title:this.resBundle.getText("TIMELINE_ADD_POST"),placement:sap.m.PlacementType.Vertical,footer:new sap.m.Bar({contentMiddle:[new sap.m.Button({text:this.resBundle.getText("TIMELINE_OK"),press:function(){t._addDialog.close();t._addPost();}}),new sap.m.Button({text:this.resBundle.getText("TIMELINE_FILTER_CANCEL"),press:function(){t._addDialog.close();}})]}),contentHeight:"15rem",contentWidth:"15rem"});this._addInput=new sap.m.TextArea({height:"15rem",width:"100%",liveChange:function(e){t._liveChange(e);}});};
sap.suite.ui.commons.Timeline.prototype._createSuggestionPopup=function(i){var t=this;this._suggestionPopup=new sap.m.Popover(i.getId()+"-suggestion_popup",{showHeader:false,placement:sap.m.PlacementType.Bottom,contentWidth:"15rem",initialFocus:i}).attachAfterClose(function(){});this._overwritePopover(this._suggestionPopup,i);this._suggestList=new sap.m.List(this.getId()+"-suggestlist",{showNoData:false,mode:sap.m.ListMode.SingleSelectMaster,selectionChange:function(e){var I=e.getSource().getSelectedItem();t._suggestionPopup.close();var s=t._addInput.getValue();var a='';var d=I.getDescription();if(d.match(/\S+@\S+\.\S+/)){a="@"+d.split('@')[0]+" ";}else{a="@"+d+" ";}var n=t._getNewString(s,t._inputDiff.val,a);t._addInput.setValue(n);t._oldAddInput=n;t.fireSuggestionItemSelected({selectedItem:I});}});this._suggestionPopup.addContent(this._suggestList);};
sap.suite.ui.commons.Timeline.prototype._overwritePopover=function(p,i){p._marginTop=0;p._marginLeft=0;p._marginRight=0;p._marginBottom=0;p._arrowOffset=0;p._offsets=["0 0","0 0","0 0","0 0"];p._myPositions=["begin bottom","begin center","begin top","end center"];p._atPositions=["begin top","end center","begin bottom","begin center"];p.open=function(){this.openBy(i,false,true);};p.oPopup.setAnimations(function(r,R,o){o();},function(r,R,c){c();});};
sap.suite.ui.commons.Timeline.prototype._liveChange=function(e){if(this._suggestionPopup&&this._suggestionPopup.isOpen()){this._suggestionPopup.close();}var s=e.getParameters().value;if(!this.getShowSuggestion()){this._oldAddInput=s;return;}var I=e.getSource();this._inputDiff=this._getDiffWord(s,this._oldAddInput);this._lastInputOp=this._inputDiff.op;if(this._inputDiff.val.match(/^@|\s@/g)&&this._inputDiff.val.length>1){if(this._lastInputOp==="A"){var t=this;if(!this._suggestionPopup){this._createSuggestionPopup(I);}this.fireSuggest({suggestValue:this._inputDiff.val});this._suggestList.destroyItems();var a=this.getSuggestionItems();for(var i=0;i<a.length;i++){this._suggestList.addItem(new sap.m.StandardListItem({icon:a[i].getIcon(),title:a[i].getTitle(),description:a[i].getDescription()}));}this._suggestionPopup.openBy(I);}else if(this._lastInputOp==="D"){var n=this._getNewString(s,this._inputDiff.val,'');this._addInput.setValue(n);}}else if(this._suggestionPopup&&this._inputDiff.val.length==0){this._suggestionPopup.close();}this._oldAddInput=s;};
sap.suite.ui.commons.Timeline.prototype._getCursorPosition=function(n,o){if(n.length>o.length){this._lastInputOp="A";for(var i=0;i<o.length;i++){if(n[i]!=o[i]){return i+1;}}return n.length;}else{this._lastInputOp="D";for(var i=0;i<n.length;i++){if(n[i]!=o[i]){return i;}}return o.length-1;}};
sap.suite.ui.commons.Timeline.prototype._getDiffWord=function(n,o){var a=[];var b=[];var c="";if(n){a=n.split(/\s|\r\n|\r|\n/g);}if(o){b=o.split(/\s|\r\n|\r|\n/g);}if(n.length<o.length){c="D";for(var i=0;i<a.length;i++){if(a[i]!=b[i]){if(a[i]==b[i+1]){return{val:"d",op:c};}else{return{val:a[i],op:c};}}}return{val:"d",op:c};}else{c="A";if(a.length>b.length){return{val:a[a.length-1],op:c};}for(var i=0;i<b.length;i++){if(b[i]!=a[i]){return{val:a[i],op:c};}}return{val:" ",op:c};}};
sap.suite.ui.commons.Timeline.prototype._getNewString=function(o,d,i){var r=new RegExp(d+'$');return o.replace(r,i);};
sap.suite.ui.commons.Timeline.prototype._addPost=function(){var i=this._addInput.getValue();this.fireAddPost({value:i,mentions:this._mentions});};
sap.suite.ui.commons.Timeline.prototype._setSuggestionList=function(){this._suggestList.destroyItems();var a=this.getSuggestionItems();for(var i=0;i<a.length;i++){this._suggestList.addItem(new sap.m.StandardListItem({icon:a[i].getIcon(),title:a[i].getTitle(),description:a[i].getDescription()}));}};
sap.suite.ui.commons.Timeline.prototype._setFilterInfoText=function(f){var F=this.resBundle.getText("TIMELINE_FILTER_INFO_BY",[f]);this._filterInfoText.setText(F);this._filterInfoText.setTooltip(F);if(f===this.resBundle.getText("TIMELINE_ALL")){this._headerInfoBar.setVisible(false);}else{this._headerInfoBar.setVisible(true);}this._filterText=f;};
sap.suite.ui.commons.Timeline.prototype._setFilterList=function(){this._aFilterList=[];this._filteredItems={};if(this.getEnableBackendFilter()){var f=this.getFilterList();var F=[];f.forEach(function(o){F.push({key:o.getKey(),text:o.getText()});});this._aFilterList=F;}else{var I=this.getContent();for(var i=0;i<I.length;i++){var k=I[i].getFilterValue();if(!k){continue;}if(k in this._filteredItems){this._filteredItems[k].push(I[i]);}else{var c=[];c.push(I[i]);this._filteredItems[k]=c;this._aFilterList.push({key:k,text:k});}};};if(!this.getEnableBackendFilter()){this._aFilterList.sort(function(a,b){return a.text.toLowerCase().localeCompare(b.text.toLowerCase());});}var e="";if(this.getEnableAllInFilterItem()&&!(this._aFilterList[0]&&this._aFilterList[0].key=="")){this._aFilterList.unshift({key:"",text:this.resBundle.getText("TIMELINE_ALL")});};var j=new sap.ui.model.json.JSONModel({items:this._aFilterList});this._filterList.setModel(j);if(this._currentFilterKey){this.setCurrentFilter(this._currentFilterKey);}else if(this.getEnableAllInFilterItem()){this._filterList.setSelectedItem(this._filterList.getItems()[0]);}};
sap.suite.ui.commons.Timeline.prototype._resetFilter=function(){if(this._aFilterList.length!==0&&!this.getEnableBackendFilter()){this._filterList.setSelectedItem(this._filterList.getItems()[0]);this._headerInfoBar.setVisible(false);};};
sap.suite.ui.commons.Timeline.prototype._openFilterDialog=function(){if(this._customFilter){this.getCustomFilter().openBy(this._filterIcon);this.fireFilterOpen();return;}this._setFilterList();if((this.getEnableBackendFilter()&&(this._aFilterList.length===0))||(this._contentChange&&!this.getEnableBackendFilter())){this._contentChange=false;}this._filterDialog.addContent(this._filterList);this._filterDialog.openBy(this._filterIcon);this.fireFilterOpen();};
sap.suite.ui.commons.Timeline.prototype._resetDisplayItems=function(f){this.invalidate();var i=this.getContent();var I=[];if(f===this.resBundle.getText("TIMELINE_ALL")){I=i;}else{I=this._filteredItems[f];}this._displayItems=I;};
sap.suite.ui.commons.Timeline.prototype.setEnableSocial=function(f){this.setProperty("enableSocial",f);};
sap.suite.ui.commons.Timeline.prototype.setData=function(d){if(d==undefined){return;}var p=this._buildPath("/",sap.suite.ui.commons.Timeline.INTERNAL_MODEL_NAME);this._internalModel.setData(d);this.setProperty("data",d,true);this.bindAggregation("content",{path:p,sorter:this._getDefaultSorter('dateTime',this.getSortOldestFirst()),factory:jQuery.proxy(this._defaultItemsFactory,this)});this._displayItems=this.getContent();this._finishLoading=true;this._contentChange=true;this._iItemCount=this.getMaxItemsCount();return this;};
sap.suite.ui.commons.Timeline.prototype._buildPath=function(p,m){var c=p;if(m)c=m+">"+p;return c;};
sap.suite.ui.commons.Timeline.prototype._getDefaultSorter=function(p,o){var d=true;if(o){d=false;}else{d=true;}if(this.getSort()){return new sap.ui.model.Sorter(p,d,false);}else{return null;}};
sap.suite.ui.commons.Timeline.prototype._defaultItemsFactory=function(i,c){var o={};o.dateTime=c.getProperty("dateTime");o.icon=c.getProperty("icon");o.userName=c.getProperty("userName");o.title=c.getProperty("title");o.text=c.getProperty("text");o.filterValue=c.getProperty("filterValue");var t=new sap.suite.ui.commons.TimelineItem(o);if(c.getProperty("content")){t.setEmbeddedControl(c.getProperty("content"));}return t;};
sap.suite.ui.commons.Timeline.prototype.onBeforeRendering=function(){var i=this.getContent();if(this._filterChange){i=this._displayItems;}this._filterChange=false;this._showMore=false;var b=this.getBindingInfo("content");if((this.getGrowing()&&(b)&&(b.model!==sap.suite.ui.commons.Timeline.INTERNAL_MODEL_NAME)&&(this.getMaxItemsCount()>this._growDisplayCount))){if((this._filterText===this.resBundle.getText("TIMELINE_ALL"))||(this.getEnableBackendFilter())){this._showMore=true;}}else if(this.getMaxItemsCount()>0){this._iItemCount=this.getMaxItemsCount();}if(this._iItemCount==0){this._iItemCount=this.getMaxItemsCount();this._showMore=false;}if(this.getForceGrowing()){this._showMore=true;}this.setOutput(i);};
sap.suite.ui.commons.Timeline.prototype.setContent=function(c){this.removeAllContent();for(var i=0;i<c.length;i++){var I=c[i];if(I._isOfTypeTimelineItem&&I._isOfTypeTimelineItem()==true){if((I.getEmbeddedControl()===null)&&(I.getText()!==null)){I.setEmbeddedControl(new sap.m.Text({text:I.getText(),maxLines:0}));}sap.suite.ui.commons.Timeline.prototype.addContent.apply(this,[I]);}}this._displayItems=this.getContent();this._finishLoading=true;this._contentChange=true;this._resetFilter();this._iItemCount=this.getMaxItemsCount();};
sap.suite.ui.commons.Timeline.prototype.sortBy=function(p,c){if(c){return function(a,b){if(a.getProperty(p)>b.getProperty(p)){return 1;}else if(a.getProperty(p)<b.getProperty(p)){return-1;}return 0;};}else{return function(a,b){if(a.getProperty(p)<b.getProperty(p)){return 1;}else if(a.getProperty(p)>b.getProperty(p)){return-1;}return 0;};}};
sap.suite.ui.commons.Timeline.prototype.onAfterRendering=function(){var t=this;if(this.getAxisOrientation()===sap.suite.ui.commons.TimelineAxisOrientation.Vertical){this.$().css("height",this._height);if(this.getEnableScroll()){this.$().find("#"+this.getId()+"-scroll").css("height",this._scHeight);}}jQuery.sap.delayedCall(150,this,function(){t._performUiChanges();});this._startItemNavigation();};
sap.suite.ui.commons.Timeline.prototype._startItemNavigation=function(e){var f=this.getDomRef(),r=f.getElementsByClassName("sapSuiteUiCommonsTimelineItemShell"),d=[];for(var i=0;i<f.childNodes.length;i++){if(f.childNodes[i].id.indexOf("filterInfoBar")<0){d.push(f.childNodes[i]);}}if(!this.oItemNavigation){this.oItemNavigation=new sap.ui.core.delegate.ItemNavigation();this.addDelegate(this.oItemNavigation);}this.oItemNavigation.setRootDomRef(r);this._aRows=r;this._aDomRefs=d;this._sapTabbable=this.$().find(":sapTabbable");this._moreButtonFound=false;this._addButtonFound=false;this._addTarget=null;this._filterTarget=null;this._moreTarget=null;this._lastMessageStripTabElem=null;this._messageStripTabFields=[];this._messageStripIsAvailable=false;this._messageStripCloseButtonTarget=null;this._firstShell=null;this._lastShell=null;this._lastTab=null;this._lastHeaderBaRTabField=null;this._firstHeaderBaRTabField=null;this._headerBarFieldLength=this.getHeaderBar().getContent().length;for(var i=0;i<this._sapTabbable.length;i++){if(this._headerBarFieldLength>=2){if(this._sapTabbable[i].id==this.getHeaderBar().getContent()[this._headerBarFieldLength-1].sId){this._lastHeaderBaRTabField=this._sapTabbable[i];if(this._firstHeaderBaRTabField===null){this._firstHeaderBaRTabField=this._sapTabbable[i];}}}if(this._headerBarFieldLength>=2){if(this._sapTabbable[i].id==this.getHeaderBar().getContent()[1].sId){if(this._firstHeaderBaRTabField===null){this._firstHeaderBaRTabField=this._sapTabbable[i];}}}if(this._sapTabbable[i].id.indexOf("shell")>=0&&this._firstShell==null){this._firstShell=this._sapTabbable[i];}if(this._sapTabbable[i].id.indexOf("shell")>=0){this._lastShell=this._sapTabbable[i];}if(this._sapTabbable[i].id.indexOf("more")<0){this._lastTab=this._sapTabbable[i];}if(this._sapTabbable[i].id.indexOf("more")>=0){this._moreButtonFound=true;this._moreTarget=this._sapTabbable[i];}if(this._sapTabbable[i].id.indexOf("add")>=0){this._addButtonFound=true;this._addTarget=this._sapTabbable[i];}if(this._sapTabbable[i].id.indexOf("filter")>=0){this._filterTarget=this._sapTabbable[i];}if(this._sapTabbable[i].className==="sapMMsgStripCloseButton"){this._messageStripCloseButtonTarget=this._sapTabbable[i];}}for(var i=0;i<this._sapTabbable.length;i++){if(this._lastMessageStripTabElem==null&&this.getMessageStrip().getText()!=''){if(this._sapTabbable[i].id.indexOf("add")>=0){continue;}if(this._sapTabbable[i].className==="sapMMsgStripCloseButton"){this._messageStripIsAvailable=true;this._lastMessageStripTabElem=this._sapTabbable[i];break;}if(this._sapTabbable[i].id.indexOf("shell")<0&&this._sapTabbable[i].id.indexOf("filter")<0){this._messageStripTabFields.push(this._sapTabbable[i]);}if(this._lastMessageStripTabElem==null&&this._sapTabbable[i].className=="sapSuiteUiCommonsTimelineItemShell"&&this._sapTabbable[i-1]){this._lastMessageStripTabElem=this._sapTabbable[i-1];break;}}}this.oItemNavigation.setItemDomRefs(d);this.oItemNavigation.setCycling(false);this._pageSize=this.getGrowingThreshold();if(this._pageSize==0){this._pageSize=10;}this.oItemNavigation.setPageSize(this._pageSize);};
sap.suite.ui.commons.Timeline.prototype._targetIdIsMessageStripTab=function(e){for(var i=0;i<this._messageStripTabFields.length;i++){if(this._messageStripTabFields[i].id===e.target.id){return true;}}return false;};
sap.suite.ui.commons.Timeline.prototype.onsaphome=function(e){this._skipOnFocusIn=true;this._setFocus(e,this._aRows[0]);this._previousTarget=this._aRows[0];this._previousShellTarget=this._aRows[0];};
sap.suite.ui.commons.Timeline.prototype.onsapend=function(e){this._skipOnFocusIn=true;this._setFocus(e,this._aRows[this._aRows.length-1]);this._previousTarget=this._aRows[this._aRows.length-1];this._previousShellTarget=this._aRows[this._aRows.length-1];};
sap.suite.ui.commons.Timeline.prototype._setFocus=function(e,i){jQuery(i).focus();e.preventDefault();e.setMarked();};
sap.suite.ui.commons.Timeline.prototype.onsappagedown=function(e){this._skipOnFocusIn=true;this._setPageDownUpFocus(e,true);};
sap.suite.ui.commons.Timeline.prototype.onsappageup=function(e){this._skipOnFocusIn=true;this._setPageDownUpFocus(e,false);};
sap.suite.ui.commons.Timeline.prototype._setPageDownUpFocus=function(e,d){var f=false;for(var i=0;i<this._aRows.length;i++){if(this._aRows[i].id==e.target.id){f=true;break;}}if(f==false){this._setFocus(e,e.target);return;}var n=0;if(d){n=i+this._pageSize;if(n>=this._aRows.length){n=this._aRows.length-1;}}else{n=i-this._pageSize;if(n<0){n=0;}}this._setFocus(e,this._aRows[n]);this._previousTarget=this._aRows[n];this._previousShellTarget=this._aRows[n];};
sap.suite.ui.commons.Timeline.prototype.onsapup=function(e){this._skipOnFocusIn=true;this._setArrowUpLeftFocus(e);};
sap.suite.ui.commons.Timeline.prototype.onsapleft=function(e){this._skipOnFocusIn=true;this._setArrowUpLeftFocus(e);};
sap.suite.ui.commons.Timeline.prototype._setArrowUpLeftFocus=function(e){var j=0;for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id==e.target.id){j=i;break;}}for(var i=j-1;i>=0;i--){if(this._sapTabbable[i].id.indexOf("shell")>=0&&this._sapTabbable[i].id!=e.target.id&&this._shell!=this._sapTabbable[i].id&&i<j){this._shell=this._sapTabbable[i].id;this._previousTarget=this._sapTabbable[i];this._previousShellTarget=this._sapTabbable[i];this._setFocus(e,this._sapTabbable[i]);break;}}};
sap.suite.ui.commons.Timeline.prototype.onsapdown=function(e){this._skipOnFocusIn=true;this._setArrowDownRightFocus(e);};
sap.suite.ui.commons.Timeline.prototype.onsapright=function(e){this._skipOnFocusIn=true;this._setArrowDownRightFocus(e);};
sap.suite.ui.commons.Timeline.prototype._setArrowDownRightFocus=function(e){if(e.target.id.indexOf("shell")<0){this._setFocus(e,this.$().find(e.target));return;}var j=0;for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id==e.target.id){j=i;break;}}for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0&&this._sapTabbable[i].id!=e.target.id&&this._shell!=this._sapTabbable[i].id&&i>j){this._shell=this._sapTabbable[i].id;this._previousTarget=this._sapTabbable[i];this._previousShellTarget=this._sapTabbable[i];this._setFocus(e,this._sapTabbable[i]);return;}}};
sap.suite.ui.commons.Timeline.prototype.onsaptabprevious=function(e){var l=null;this._tabprevious=true;if(!this._targetIdInHeaderBar(e)&&e.target.id.indexOf("more")<0&&e.target.className!=="sapMMsgStripCloseButton"){if(!this._targetIdIsMessageStripTab(e)){this._previousTabPreviousTarget=e.target;}}if(this.oItemNavigation){this.removeDelegate(this.oItemNavigation);this.oItemNavigation.destroy();}this._startItemNavigation();var t=this._sapTabbable;var p=null;if(e.target.id.indexOf("getmore")>=0){if(this._previousTarget==null){l=this._getLastInteractiveElementInItem(this._getFirstShellTarget());jQuery(l).focus();}else{var s=false;if(this._previousShellTarget!=null){for(var i=0;i<this._sapTabbable.length;i++){if(this._previousShellTarget.id==this._sapTabbable[i].id){l=this._getLastInteractiveElementInItem(this._sapTabbable[i]);this._previousTarget=l;this._setFocus(e,l);s=true;return;}}}var l=null;if(!s){for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0){p=this._sapTabbable[i];l=this._getLastInteractiveElementInItem(this._getFirstShellTarget());this._previousTarget=l;this._previousShellTarget=this._sapTabbable[i];this._setFocus(e,l);return;}}}}e.preventDefault();e.setMarked();return;}if(e.target.id.indexOf("shell")>=0){if(this._messageStripIsAvailable){this._setFocus(e,this._messageStripCloseButtonTarget);return;}if(this._lastHeaderBaRTabField!==null){this._setFocus(e,this._lastHeaderBaRTabField);return;}jQuery(this._firstShell).focus();}if(e.target.id==this._firstHeaderBaRTabField.id){this._dummy=true;}};
sap.suite.ui.commons.Timeline.prototype._getLastInteractiveElementInItem=function(t){if(t==null){return;}var L=t;var j=0;for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id==t.id){j=i;break;}}var n=false;var l=0;for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0&&this._sapTabbable[i]!=t&&i>j){n=true;break;}else{L=this._sapTabbable[i];l=i;}}if(L.id.indexOf("more")>=0&&l>0){L=this._sapTabbable[l-1];}return L;};
sap.suite.ui.commons.Timeline.prototype._getFirstShellTarget=function(){var F=null;for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0){F=this._sapTabbable[i];break;}}return F;};
sap.suite.ui.commons.Timeline.prototype._getItemShellTarget=function(t){var a=null;var c=0;if(t==null){return a;}if(t.id.indexOf("shell")>=0){return t;}var p=-1;for(var i=0;i<this._sapTabbable.length;i++){if(t.id==this._sapTabbable[i].id){p=i;break;}}if(p>=0){for(var j=p-1;j>=0;j--){if(this._sapTabbable[j].id.indexOf("shell")>=0){a=this._sapTabbable[j];break;}}}return a;};
sap.suite.ui.commons.Timeline.prototype.onsaptabnext=function(e){this._tabnext=true;this._dummy=false;if(this.oItemNavigation){this.removeDelegate(this.oItemNavigation);this.oItemNavigation.destroy();}this._startItemNavigation();for(var i=0;i<this._headerBarFieldLength;i++){if(e.target.id===this.getHeaderBar().getContent()[i].sId&&e.target.id===this._lastHeaderBaRTabField.id){if(!this._messageStripIsAvailable&&this._previousShellTarget!=null){for(var i=0;i<this._sapTabbable.length;i++){if(this._previousShellTarget.id==this._sapTabbable[i].id){this._setFocus(e,this._sapTabbable[i]);return;}}}}if(e.target.id===this.getHeaderBar().getContent()[i].sId){return;}}var t=-1;for(var i=0;i<this._sapTabbable.length;i++){if(e.target.id==this._sapTabbable[i].id){t=i;break;}}if(d&&this._targetIdInHeaderBar(e)){return;}if(e.target.className==="sapMMsgStripCloseButton"&&this._previousShellTarget!=null){for(var i=0;i<this._sapTabbable.length;i++){if(this._previousShellTarget.id==this._sapTabbable[i].id){this._setFocus(e,this._sapTabbable[i]);return;}}}if(e.target.id.indexOf("more")<0&&!this._targetIdInHeaderBar(e)&&e.target.id!=""){if(t==this._sapTabbable.length-1){this._setFocusOnMoreOrOutOfFocusArea(e);}if(t<this._sapTabbable.length-1&&this._sapTabbable[t+1].id.indexOf("shell")>=0){this._setFocusOnMoreOrOutOfFocusArea(e);}}var p=null;if(this._targetIdIsLastHeaderBarBtn(e)&&this._previousTarget!=null&&e.target!=this._previousTarget){if(this._messageStripIsAvailable){return;}if(this._previousTarget.id.indexOf("shell")>=0){var s=false;for(var i=0;i<this._sapTabbable.length;i++){if(this._previousTarget.id==this._sapTabbable[i].id){this._setFocus(e,this._sapTabbable[i]);return;}}if(!s){for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0){p=this._sapTabbable[i];break;}}}}else{var s=false;if(this._previousShellTarget!=null){for(var i=0;i<this._sapTabbable.length;i++){if(this._previousShellTarget.id==this._sapTabbable[i].id){this._setFocus(e,this._sapTabbable[i]);s=true;return;}}}if(!s){for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0){p=this._sapTabbable[i];this._previousTarget=this._sapTabbable[i];this._previousShellTarget=this._sapTabbable[i];break;}}}}if(p==null){for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0){break;}}}this._setFocus(e,p);return;}if(e.target.id.indexOf("getmore")<0&&!this._targetIdInHeaderBar(e)&&e.target.className!=="sapMMsgStripCloseButton"){var d=false;for(var i=0;i<this._messageStripTabFields.length;i++){if(this._messageStripTabFields[i].id==e.target.id){d=true;break;}}if(!d){this._previousTarget=e.target;this._previousShellTarget=this._getItemShellTarget(e.target);}}};
sap.suite.ui.commons.Timeline.prototype._setFocusOnMoreOrOutOfFocusArea=function(e){if(!this._moreButtonFound){jQuery(this._sapTabbable[this._sapTabbable.length-1]).focus();this._dummy=true;this._previousTarget=e.target;this._previousShellTarget=this._getItemShellTarget(e.target);return;}if(this._moreButtonFound){this._previousTarget=e.target;this._previousShellTarget=this._getItemShellTarget(e.target);this._setFocus(e,this._moreTarget);return;}};
sap.suite.ui.commons.Timeline.prototype._switchFocus=function(e){var i=this._getItemShellTarget(e.target);var c=this._getItemShellTarget(this._saveTarget);if(this._saveTarget!=null&&e.target!=null&&i!=c){if(e.target.id.indexOf("item")<0&&e.target.id.indexOf("shell")<0){this._saveTarget=e.target;}return;}if(e.target.id.indexOf("item")>=0&&e.target.id.indexOf("shell")>=0){jQuery(e.target).blur();jQuery(this._saveTarget).focus();}else{if(i!=null){this._saveTarget=e.target;jQuery(e.target).blur();jQuery(i).focus();}}};
sap.suite.ui.commons.Timeline.prototype.onkeydown=function(e){this._skipOnFocusIn=false;this._firstTimeSetFocus=true;if(e.which==jQuery.sap.KeyCodes.F7&&!e.isMarked()){this._skipOnFocusIn=true;this._switchFocus(e);e.preventDefault();e.setMarked();return;}};
sap.suite.ui.commons.Timeline.prototype.onsapspace=function(e){};
sap.suite.ui.commons.Timeline.prototype.onfocusout=function(e){this._outFocusTarget=e.target;this._outFocusTargetClassName=e.target.className;};
sap.suite.ui.commons.Timeline.prototype.onfocusin=function(e){if(this._firstHeaderBaRTabField==null){if(!this._dummy&&this._previousTarget==null&&!this._moreButtonFound&&this._tabnext==false&&e.target.id==this._sapTabbable[this._sapTabbable.length-1].id){this._setFocusOnMoreAddFilterButton(e);return;}return;}if(this._skipOnFocusIn){return;}if(this._dummy&&!this._targetIdInHeaderBar(e)&&this._previousTarget!=null){this._dummy=false;if(this._moreButtonFound){this._setFocus(e,this._moreTarget);return;}if(e.target.id.indexOf("shell")>=0&&this._previousShellTarget!==null){if(e.target==this._firstShell){this._setFocus(e,this._previousShellTarget);this._tabprevious=false;return;}if(e.target==this._lastShell){var l=this._getLastInteractiveElementInItem(this._previousShellTarget);this._setFocus(e,l);this._tabprevious=false;return;}}var l=this._getLastInteractiveElementInItem(this._previousTarget);this._setFocus(e,l);return;}if(this._dummy&&!this._targetIdInHeaderBar(e)&&this._previousTarget==null){this._tabprevious=false;this._dummy=false;if(this._moreButtonFound&&e.target.id.indexOf("more")<0){this._setFocus(e,this._moreTarget);return;}}if(!this._dummy&&this._previousTarget==null&&this._moreButtonFound&&this._tabnext==false&&e.target==this._firstShell){if(this._moreButtonFound&&e.target.id.indexOf("more")<0){var o=null;if(this._outFocusTarget!=null&&e.target.id.indexOf("shell")>=0){o=this._getItemShellTarget(this._outFocusTarget);if(e.target==o){return;}}}}if(!this._dummy&&this._previousTarget!==null&&this._moreButtonFound&&e.target==this._firstShell){if(this._outFocusTargetClassName!=="sapMMsgStripCloseButton"&&this._outFocusTarget!==this._filterTarget){if(this._moreButtonFound&&e.target.id.indexOf("more")<0){var o=null;if(this._outFocusTarget!=null&&e.target.id.indexOf("shell")>=0){o=this._getItemShellTarget(this._outFocusTarget);if(e.target==o){return;}}if(this._outFocusTarget!==this._moreTarget){this._setFocus(e,this._moreTarget);return;}}}}if(!this._dummy&&this._previousTarget==null&&!this._moreButtonFound&&this._tabnext==false&&e.target.id==this._sapTabbable[this._sapTabbable.length-1].id){this._setFocusOnMoreAddFilterButton(e);return;}if(!this._dummy&&this._previousTarget==null&&!this._moreButtonFound&&this._tabnext==false&&this._firstTimeSetFocus==true&&!this._targetIdInHeaderBar(e)){var t=null;for(var i=0;i<this._sapTabbable.length;i++){if(e.target.id==this._sapTabbable[i].id){t=i;break;}}var a=this._sapTabbable.length-1;if(t!==null&&t<a){this._firstTimeSetFocus=false;this._setFocus(e,this._firstShell);return;}}};
sap.suite.ui.commons.Timeline.prototype._targetIdInHeaderBar=function(e){for(var i=0;i<this._headerBarFieldLength;i++){if(e.target.id===this.getHeaderBar().getContent()[i].sId){return true;}}return false;};
sap.suite.ui.commons.Timeline.prototype._targetIdIsLastHeaderBarBtn=function(e){if(e.target.id===this._lastHeaderBaRTabField.id){return true;}return false;};
sap.suite.ui.commons.Timeline.prototype._targetIdIsFirstHeaderBarBtn=function(e){if(e.target.id===this._firstHeaderBaRTabField.id){return true;}return false;};
sap.suite.ui.commons.Timeline.prototype._setFocusOnMoreAddFilterButton=function(e){this._tabprevious=false;var f=this._getFirstShellTarget();var l=this._getLastInteractiveElementInItem(f);this._previousTarget=l;this._previousShellTarget=f;this._setFocus(e,l);};
sap.suite.ui.commons.Timeline.prototype.onsapskipforward=function(e){this._skipOnFocusIn=true;this._tabnext=false;this._dummy=true;if(this.oItemNavigation){this.removeDelegate(this.oItemNavigation);this.oItemNavigation.destroy();}this._startItemNavigation();if(!this._targetIdInHeaderBar(e)&&e.target.id.indexOf("more")<0&&e.target.className!=="sapMMsgStripCloseButton"){if(!this._targetIdIsMessageStripTab(e)){this._previousTabPreviousTarget=e.target;}}if(e.target.id.indexOf("more")>=0){return;}if(e.target.id.indexOf("shell")>=0){if(this._moreButtonFound){this._setFocus(e,this._moreTarget);return;}jQuery(this._sapTabbable[this._sapTabbable.length-1]).focus();return;}if(e.target.className==="sapMMsgStripCloseButton"){this._findNextF6ShellTarget(e);return;}if(e.target.id.indexOf("shell")<0&&!this._targetIdInHeaderBar(e)&&e.target.id.indexOf("more")<0){var s=null;s=this._getItemShellTarget(e.target);if(this._moreButtonFound){this._setFocus(e,this._moreTarget);return;}jQuery(this._sapTabbable[this._sapTabbable.length-1]).focus();return;}if(this._previousTarget==null&&!this._targetIdInHeaderBar(e)){this._setFocus(e,this._firstHeaderBaRTabField);return;}if(this._targetIdIsLastHeaderBarBtn(e)){if(this._messageStripIsAvailable){var n=null;for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].className=="sapMMsgStripCloseButton"){n=this._sapTabbable[i];break;}}if(n!==null){this._setFocus(e,this._sapTabbable[2]);return;}}if(this._previousTarget==null){var f=this._getFirstShellTarget();this._previousTarget=f;this._previousShellTarget=f;this._setFocus(e,f);return;}}var p=null;if(this._targetIdIsLastHeaderBarBtn(e)&&this._previousTarget!=null&&e.target!=this._previousTarget){this._findNextF6ShellTarget(e);return;}};
sap.suite.ui.commons.Timeline.prototype._findNextF6ShellTarget=function(e){if(this._previousShellTarget!=null){for(var i=0;i<this._sapTabbable.length;i++){if(this._previousShellTarget.id==this._sapTabbable[i].id){this._setFocus(e,this._sapTabbable[i]);return;}}}for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0){this._previousShellTarget=this._sapTabbable[i];this._setFocus(e,this._sapTabbable[i]);break;}}if(this._previousTarget.id.indexOf("shell")>=0){for(var i=0;i<this._sapTabbable.length;i++){if(this._previousTarget.id==this._sapTabbable[i].id){this._setFocus(e,this._sapTabbable[i]);return;}}}for(var i=0;i<this._sapTabbable.length;i++){if(this._sapTabbable[i].id.indexOf("shell")>=0){this._previousShellTarget=this._sapTabbable[i];this._setFocus(e,this._sapTabbable[i]);break;}}};
sap.suite.ui.commons.Timeline.prototype.onsapskipback=function(e){this._skipOnFocusIn=true;this._dummy=true;if(this.oItemNavigation){this.removeDelegate(this.oItemNavigation);this.oItemNavigation.destroy();}this._startItemNavigation();if(e.target.id.indexOf("shell")>=0){this._previousShiftF6Target=e.target;}if(this._messageStripIsAvailable&&e.target.id.indexOf("shell")>=0){this._setFocus(e,this._messageStripCloseButtonTarget);return;}if(e.target.id.indexOf("shell")>=0){if(this._messageStripCloseButtonTarget!==null){this._setFocus(e,this._messageStripCloseButtonTarget);return;}if(this._firstHeaderBaRTabField!=null){this._setFocus(e,this._firstHeaderBaRTabField);return;}jQuery(this._firstShell).focus();return;}if(e.target.className==="sapMMsgStripCloseButton"){return;}if(e.target.id.indexOf("shell")>=0&&!this._targetIdInHeaderBar(e)){this._setFocus(e,this._lastHeaderBaRTabField);return;};if(e.target.id.indexOf("more")>=0&&this._previousTarget===null){this._setFocus(e,this._getFirstShellTarget());return;};if(e.target.id.indexOf("more")>=0&&this._previousTarget!==null){if(this._previousTarget.id.indexOf("shell")>=0){for(var i=0;i<this._sapTabbable.length;i++){if(this._previousTarget.id==this._sapTabbable[i].id){this._setFocus(e,this._sapTabbable[i]);return;}}}else{for(var i=0;i<this._sapTabbable.length;i++){if(this._previousTarget.id==this._sapTabbable[i].id){break;}}this._setFocus(e,this._getItemShellTarget(this._sapTabbable[i]));return;}};if(e.target.id.indexOf("shell")<0&&!this._targetIdInHeaderBar(e)&&e.target.id.indexOf("more")<0){if(this._previousTarget==null){if(this._moreButtonFound){this._setFocus(e,this._moreTarget);return;}l=this._getLastInteractiveElementInItem(this._getFirstShellTarget());jQuery(l).focus();return;}}var l=null;var p=null;var S=null;if(!this._targetIdInHeaderBar(e)&&e.target.id.indexOf("more")<0){if(this._previousTarget==null){l=this._getLastInteractiveElementInItem(this._getFirstShellTarget());jQuery(l).focus();}else{var s=false;S=this._getItemShellTarget(this._previousShellTarget);s=true;if(s){p=S;jQuery(S).focus();e.preventDefault();e.setMarked();return;}}e.preventDefault();e.setMarked();return;}};
sap.suite.ui.commons.Timeline.prototype._performUiChanges=function(){if(this.getAxisOrientation()===sap.suite.ui.commons.TimelineAxisOrientation.Vertical){this._performUiChangesV();}else{this._performUiChangesH();}};
sap.suite.ui.commons.Timeline.prototype._performUiChangesH=function(){var t=this.$();var m=this.getId();if(m.indexOf("\.")!=-1){m=m.replace(/(:|\.|\[|\])/g,"\\$1");}var _=t.find("#"+m+"-filterToolBar").outerHeight();var a=t.find("#"+m+"-filterInfoBar").outerHeight();var c=t.find('.sapSuiteUiCommonsTimelineContentsH');var s=t.height();c.css({'height':s-(_+a)});};
sap.suite.ui.commons.Timeline.prototype._performUiChangesV=function(){var s=this.getShowIcons();var t=this.$();var l=t.find('li');for(var i=0;i<l.length;i++){var a=i+1;var c=t.find('li:nth-child('+a+')').find('.sapSuiteUiCommonsTimelineItemBox').css('height');if(c!==undefined){var b=parseInt(c.replace("px",""))+23;if(i===(l.length-1)){b+=28;}t.find('li:nth-child('+a+')').css({'height':b+'px'});var d=t.find('li:nth-child('+a+')').find('.sapSuiteUiCommonsTimelineItemBar');if(!s){d.css({'height':(b-17)+'px'});d.css({'top':30+'px'});}else{d.css({'height':(b-34)+'px'});}}}this._performScrollChanges();};
sap.suite.ui.commons.Timeline.prototype._performScrollChanges=function(){if(this.getAxisOrientation()===sap.suite.ui.commons.TimelineAxisOrientation.Vertical){var t=this.$();var _=t.parent().outerHeight();var a=t.parent().height();var b=0;var c=t.parent().children();for(var i=0;i<c.length;i++){var d=c[i];if(d.className!="sapSuiteUiCommonsTimeline"){b+=d.clientHeight;}}_=_-b;var e=false;if(a<=50||(a-b)<=50){e=true;}this._height=_-28;t.css({'height':this._height});var m=this.getId();if(m.indexOf("\.")!=-1){m=m.replace(/(:|\.|\[|\])/g,"\\$1");}var f=t.find("#"+m+"-filterToolBar").outerHeight()+28;var g=t.find("#"+m+"-filterInfoBar").outerHeight();if(e){if(this.getEnableScroll()){t.find("#"+m+"-scroll").css({'height':'400px'});}t.parent().css({'height':'400px'});t.parent().css({'height':(t.parent().outerHeight()+b+f+g)});this._scHeight=400;}else{this._scHeight=_-(f+g);if(this.getEnableScroll()){t.find("#"+m+"-scroll").css({'height':this._scHeight});}}}};
sap.suite.ui.commons.Timeline.prototype.setOutput=function(I){this._outputItem=[];var s=this.getShowIcons();if(I.length>1){if(this.getSort()){I.sort(this.sortBy('dateTime',this.getSortOldestFirst()));}}var d=I.length;if(this._showMore&&d>this._growDisplayCount){d=this._growDisplayCount;}for(var i=0;i<d;i++){var _=I[i];var a;if(!s){_._showIcons=true;}if(i==(I.length-1)){if(this._showMore){a=sap.suite.ui.commons.TimelineItemPosition.Middle;}else{a=sap.suite.ui.commons.TimelineItemPosition.Bottom;}}else if(i==0){a=sap.suite.ui.commons.TimelineItemPosition.Top;}else{a=sap.suite.ui.commons.TimelineItemPosition.Middle;}_.setLayout(a,"Right");this._outputItem.push(_);}};
sap.suite.ui.commons.Timeline.prototype.refreshContent=function(r){this._finishLoading=false;if(this.getEnableBusyIndicator()){this.setBusy(true);}var b=this.getBindingInfo("content");var B=this.getBinding("content");if(this.getGrowing()&&(b)&&(b.model!==sap.suite.ui.commons.Timeline.INTERNAL_MODEL_NAME)&&(B)&&(B.getModel())&&(B.getModel().getDefaultCountMode()!==sap.ui.model.odata.CountMode.None)){this._growing=true;this._iItemCount=this.getGrowingThreshold();this._growDisplayCount=this.getGrowingThreshold();B.getContexts(0,this._iItemCount);b.length=this._iItemCount;}else{this.updateAggregation("content");}this._filterText=this.resBundle.getText("TIMELINE_ALL");};
sap.suite.ui.commons.Timeline.prototype.updateContent=function(r){if(this.getEnableBusyIndicator()&&this.getBusy()){this.setBusy(false);}var b=this.getBinding("content");if(this._growing){b.getContexts(0,this._iItemCount);}this.updateAggregation("content");this._finishLoading=true;this._contentChange=true;if(!this.getEnableBackendFilter()){this._resetFilter();}};
sap.suite.ui.commons.Timeline.prototype.updateFilterList=function(){this.updateAggregation("filterList");this._setFilterList();};
sap.suite.ui.commons.Timeline.prototype.refreshSuggestionItems=function(r){this._suggestList.setBusy(true);this.updateAggregation("suggestionItems");};
sap.suite.ui.commons.Timeline.prototype.updateSuggestionItems=function(){this.updateAggregation("suggestionItems");this._setSuggestionList();this._suggestList.setBusy(false);};
sap.suite.ui.commons.Timeline.prototype.setSuspendSocialFeature=function(s){this._suspenseSocial=s;if(!this.getEnableSocial()){return;}if(s){var I=this.getContent();for(var i=0;i<I.length;i++){I[i]._replyLink.setEnabled(false);};}else{var I=this.getContent();for(var i=0;i<I.length;i++){I[i]._replyLink.setEnabled(true);};}this.invalidate();};
sap.suite.ui.commons.Timeline.prototype.getSuspendSocialFeature=function(){return this._suspenseSocial;};
sap.suite.ui.commons.Timeline.prototype.setCustomFilter=function(f){if(f){this._customFilter=true;this.setAggregation("customFilter",f,true);}else{this._customFilter=false;}};
sap.suite.ui.commons.Timeline.prototype.setCustomMessage=function(m){this._filterInfoText.setText(m);if(m&&m.length>0){this._headerInfoBar.setVisible(true);}else{this._headerInfoBar.setVisible(false);}this.invalidate();};
sap.suite.ui.commons.Timeline.prototype.getHeaderBar=function(){return this._headerBar;};
sap.suite.ui.commons.Timeline.prototype.getMessageStrip=function(){return this._messageStrip;};
sap.suite.ui.commons.Timeline.prototype.exit=function(){if(this._emptyList){this._emptyList.destroy();this._emptyList=undefined;}if(this._filterIcon){this._filterIcon.destroy();this._filterIcon=undefined;}if(this._filterDialog){this._filterDialog.destroy();this._filterDialog=undefined;}if(this._filterList){this._filterList.destroy();this._filterList=undefined;}if(this._headerBar){this._headerBar.destroy();this._headerBar=undefined;}if(this._filterInfoText){this._filterInfoText.destroy();this._filterInfoText=undefined;}if(this._addInput){this._addInput.destroy();this._addInput=undefined;}if(this._addDialog){this._addDialog.destroy();this._addDialog=undefined;}if(this._headerInfoBar){this._headerInfoBar.destroy();this._headerInfoBar=undefined;}if(this._getMoreButton){this._getMoreButton.destroy();this._getMoreButton=undefined;}if(this.oItemNavigation){this.removeDelegate(this.oItemNavigation);this.oItemNavigation.destroy();}if(this._suggestList){this._suggestList.destroy();this._suggestList=undefined;}if(this._suggestionPopup){this._suggestionPopup.destroy();this._suggestionPopup=undefined;}if(this._messageStrip){this._messageStrip.destroy();this._messageStrip=undefined;}};
sap.suite.ui.commons.Timeline.prototype.setNoDataText=function(n){if((n!==null)&&(n!==undefined)&&(n!=="")){this.setProperty("noDataText",n,true);this._emptyList.setNoDataText(n);}else{this._emptyList.setNoDataText(this.resBundle.getText('TIMELINE_NO_DATA'));}};
sap.suite.ui.commons.Timeline.prototype.setShowHeaderBar=function(s){this.setProperty("showHeaderBar",s,true);this._headerBar.setVisible(s);};
sap.suite.ui.commons.Timeline.prototype.getMaxItemsCount=function(){var b=this.getBinding("content");var l=this.getContent().length;if(b){if(l<b.getLength()){return b.getLength()||0;}}return l;};
sap.suite.ui.commons.Timeline.prototype.setGrowing=function(g){if(this.getGrowing()!=g){this.setProperty("growing",g,!g);}};
sap.suite.ui.commons.Timeline.prototype.setGrowingThreshold=function(g){this.setProperty("growingThreshold",g,true);this._iItemCount=g;this._growDisplayCount=g;};
sap.suite.ui.commons.Timeline.prototype.getCurrentFilter=function(){var s=this._filterList.getSelectedItem();if(s){return this._filterList.getSelectedItem().getKey();}else{return null;}};
sap.suite.ui.commons.Timeline.prototype.setCurrentFilter=function(s){this._currentFilterKey=s;var a=this._filterList.getItems();if(this.getEnableBackendFilter()&&(a.length===0)){this._setFilterList();}else{var b;for(var i=0;i<a.length;i++){if(s===a[i].getKey()){b=a[i];};};if(b){this._filterList.setSelectedItem(b);this._setFilterInfoText(b.getLabel());}}};
sap.suite.ui.commons.Timeline.prototype.onclick=function(e){if(jQuery(e.target).parents('.sapSuiteUiCommonsTimelineItemShell').length===1){var s=jQuery(e.target).parents('.sapSuiteUiCommonsTimelineItem').attr('id');var a=sap.ui.core.Core().byId(s);this.fireSelect({selectedItem:a});}};

/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2013 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.suite.ui.commons.NoteTaker");jQuery.sap.require("sap.suite.ui.commons.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.suite.ui.commons.NoteTaker",{metadata:{publicMethods:["getAllTags","setNextCardUid","uploadAttachment","setAttachmentData","handleAttachmentUploadFail","setNextCardAttachmentUrl"],library:"sap.suite.ui.commons",properties:{"visibleNotes":{type:"int",group:"Misc",defaultValue:2},"cardViewAllTrigger":{type:"int",group:"Misc",defaultValue:1800},"filterCriteria":{type:"object",group:"Misc",defaultValue:null},"attachmentUploadUrl":{type:"string",group:"Misc",defaultValue:null},"attachmentName":{type:"string",group:"Misc",defaultValue:'attachment'}},aggregations:{"cards":{type:"sap.suite.ui.commons.NoteTakerCard",multiple:true,singularName:"card"},"carousel":{type:"sap.ui.commons.Carousel",multiple:false,visibility:"hidden"}},events:{"addCard":{},"deleteCard":{},"editCard":{},"attachmentSelect":{},"attachmentUploadComplete":{},"attachmentDelete":{},"attachmentClick":{}}}});sap.suite.ui.commons.NoteTaker.M_EVENTS={'addCard':'addCard','deleteCard':'deleteCard','editCard':'editCard','attachmentSelect':'attachmentSelect','attachmentUploadComplete':'attachmentUploadComplete','attachmentDelete':'attachmentDelete','attachmentClick':'attachmentClick'};jQuery.sap.require("sap.ui.commons.Carousel");jQuery.sap.require("sap.ui.commons.SearchField");(function(){sap.suite.ui.commons.NoteTaker.prototype.init=function(){this._rb=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");this._bFilterTagPopupOpen=false;this._bSearchPopupOpen=false;var t=this;this._carousel=new sap.ui.commons.Carousel({id:this.getId()+"-carousel",height:"540px"});this.setAggregation("carousel",this._carousel);this._carousel.addContent(this._createFeederAndAddToThis());this._notFilteredCards=[];this._oHomeButton=new sap.ui.commons.Button({id:this.getId()+"-home-button",tooltip:this._rb.getText("NOTETAKER_BUTTON_HOME_TOOLTIP"),press:function(){t._handleHomeButton();}});this._oHomeButton.addStyleClass("sapSuiteUiCommonsNoteTakerHomeButton");this._oFilterTagButton=new sap.ui.commons.Button({id:this.getId()+"-filterTag-button",tooltip:this._rb.getText("NOTETAKER_BUTTON_FILTER_TAG_TOOLTIP"),press:function(){t._toggleFilterTagPopup();}});this._oFilterTagButton.addStyleClass("sapSuiteUiCommonsNoteTakerFilterTagButton");this._oFilterThumbUpButton=new sap.ui.commons.Button({id:this.getId()+"-filter-thumb-up-button",tooltip:this._rb.getText("NOTETAKER_BUTTON_FILTER_THUMB_UP_TOOLTIP"),press:function(){t._handleFilteringByThumbUp();}});this._oFilterThumbUpButton.addStyleClass("sapSuiteUiCommonsNoteTakerFilterThumbUpButton");this._oFilterThumbDownButton=new sap.ui.commons.Button({id:this.getId()+"-filter-thumb-down-button",tooltip:this._rb.getText("NOTETAKER_BUTTON_FILTER_THUMB_DOWN_TOOLTIP"),press:function(){t._handleFilteringByThumbDown();}});this._oFilterThumbDownButton.addStyleClass("sapSuiteUiCommonsNoteTakerFilterThumbDownButton");this._oFilterAllButton=new sap.ui.commons.Button({id:this.getId()+"-filterAll-button",text:this._rb.getText("NOTETAKER_BUTTON_FILTER_ALL_TEXT"),tooltip:this._rb.getText("NOTETAKER_BUTTON_FILTER_ALL_TOOLTIP"),press:function(){t._handleResetFilters();}});this._oFilterAllButton.addStyleClass("sapSuiteUiCommonsNoteTakerFilterAllButton");this._oSearchButton=new sap.ui.commons.Button({id:this.getId()+"-filter-search-button",tooltip:this._rb.getText("NOTETAKER_BUTTON_SEARCH_TOOLTIP"),press:function(){t._handleSearchPopup();}});this._oSearchButton.addStyleClass("sapSuiteUiCommonsNoteTakerSearchBtn");this._oFilterSearchField=new sap.ui.commons.SearchField({id:this.getId()+"-filter-searchField",tooltip:this._rb.getText("NOTETAKER_BUTTON_SEARCH_TOOLTIP"),showListExpander:false,enableFilterMode:true,enableListSuggest:false,search:function(e){t._handleSearchingByText(e.getParameter("query"));}});this._oFilterSearchField.addStyleClass("suiteUiNtFilterSearchField");this._oFilterTagList=new sap.ui.commons.ListBox({id:this.getId()+"-filterTag-listBox",allowMultiSelect:true,visibleItems:10,width:"100%",height:"194px"});this._oCancelFilterTagButton=new sap.ui.commons.Button({id:this.getId()+"-cancel-filterTags-button",text:this._rb.getText("NOTETAKERFEEDER_BUTTON_CANCEL_TAGS"),tooltip:this._rb.getText("NOTETAKERFEEDER_BUTTON_CANCEL_TAGS_TOOLTIP"),press:function(){t._toggleFilterTagPopup();}});this._oCancelFilterTagButton.addStyleClass("sapSuiteUiCommonsNoteTakerCancelFilterTagButton");this._oCancelFilterTagButton.onfocusout=function(e){t._oFilterTagList.focus();};this._oApplyFilterTagButton=new sap.ui.commons.Button({id:this.getId()+"-apply-filterTags-button",text:this._rb.getText("NOTETAKER_BUTTON_FILTER_TAG_APPLY_TEXT"),tooltip:this._rb.getText("NOTETAKER_BUTTON_FILTER_TAG_APPLY_TOOLTIP"),press:function(){t._toggleFilterTagPopup();setTimeout(function(){t._handleFilteringByTags();},400);}});};sap.suite.ui.commons.NoteTaker.prototype.onBeforeRendering=function(){this._carousel.setVisibleItems(this.getVisibleNotes());this._adjustFilteringButtonsStyle();this._feeder.setAttachmentName(this.getAttachmentName());};sap.suite.ui.commons.NoteTaker.prototype.onAfterRendering=function(){this._adjustPopupState();if(!this.getAttachmentUploadUrl()){jQuery.sap.byId(this._feeder._oAddAttachButton.getId()).hide();};jQuery.sap.byId(this._oFilterThumbUpButton.getId()).attr("aria-pressed",this.getFilterCriteria()&&this.getFilterCriteria().thumbUp);jQuery.sap.byId(this._oFilterThumbDownButton.getId()).attr("aria-pressed",this.getFilterCriteria()&&this.getFilterCriteria().thumbDown);};sap.suite.ui.commons.NoteTaker.prototype.exit=function(){this.destroyAggregation("carousel",true);this._carousel=null;this._oHomeButton.destroy();this._oHomeButton=null;this._oFilterTagButton.destroy();this._oFilterTagButton=null;this._oFilterThumbUpButton.destroy();this._oFilterThumbUpButton=null;this._oFilterThumbDownButton.destroy();this._oFilterThumbDownButton=null;this._oFilterAllButton.destroy();this._oFilterAllButton=null;this._oFilterTagList.destroy();this._oFilterTagList=null;this._oCancelFilterTagButton.destroy();this._oCancelFilterTagButton=null;this._oApplyFilterTagButton.destroy();this._oApplyFilterTagButton=null;this._oFilterSearchField.destroy();this._oFilterSearchField=null;this._oSearchButton.destroy();this._oSearchButton=null;};sap.suite.ui.commons.NoteTaker.prototype._handleAddNote=function(e){var t=e.getParameter("title");var b=e.getParameter("body");var a=e.getParameter("timestamp");var c=e.getParameter("tags");var d=e.getParameter("thumbUp");var f=e.getParameter("thumbDown");var g=e.getParameter("attachmentFilename");var h={};h.title=t;h.body=b;h.timestamp=a;h.viewAllTrigger=this.getCardViewAllTrigger();h.tags=c;h.thumbUp=d;h.thumbDown=f;h.attachmentFilename=g;h.uid=this._nextCardUid;h.attachmentUrl=this._nextCardAttachmentUrl;var B=this.getBinding("cards");if(B){this.fireAddCard(h);var T=new sap.ui.model.Sorter("timestamp",true);B.sort(T);}else{var n=new sap.suite.ui.commons.NoteTakerCard();n.setBody(b);n.setHeader(t);n.setTimestamp(a);n.setViewAllTrigger(this.getCardViewAllTrigger());n.setTags(c);n.setThumbUp(d);n.setThumbDown(f);n.setAttachmentFilename(g);n.setUid(this._nextCardUid);n.setAttachmentUrl(this._nextCardAttachmentUrl);this.insertCard(n,0);h.card=n;this.fireAddCard(h);}this._nextCardUid=null;this._nextCardAttachmentUrl=null;this._filter();};sap.suite.ui.commons.NoteTaker.prototype.addCard=function(c){this._addDeleteDelegate(c);this._addEditDelegate(c);this._addAttachmentDelegate(c);this.getNotFilteredCards().push(c);this._carousel.addContent(c);this._sortIfNeeded();this._spreadTagList();return this;};sap.suite.ui.commons.NoteTaker.prototype.getCards=function(){return this._carousel.getContent().slice(1);};sap.suite.ui.commons.NoteTaker.prototype.insertCard=function(c,i){this._addDeleteDelegate(c);this._addEditDelegate(c);this._addAttachmentDelegate(c);this.getNotFilteredCards().push(c);this._carousel.insertContent(c,++i);this._spreadTagList();return this;};sap.suite.ui.commons.NoteTaker.prototype.removeCard=function(c){this._spreadTagList();return this._carousel.removeContent(c);};sap.suite.ui.commons.NoteTaker.prototype.removeAllCards=function(){var c=this._carousel.removeAllContent();this._feeder.setTags([]);this._carousel.addContent(this._feeder);return c.slice(1);};sap.suite.ui.commons.NoteTaker.prototype.indexOfCard=function(c){var i=this._carousel.indexOfContent(c);return(i>0)?--i:-1;};sap.suite.ui.commons.NoteTaker.prototype.destroyCards=function(){this._carousel.destroyContent();this._carousel.addContent(this._createFeederAndAddToThis());return this;};sap.suite.ui.commons.NoteTaker.prototype._createFeederAndAddToThis=function(){var t=this;this._feeder=new sap.suite.ui.commons.NoteTakerFeeder({id:this.getId()+"-feeder",attachmentName:t.getAttachmentName(),addNote:function(e){t._handleAddNote(e);},attachmentUploadUrl:t.getAttachmentUploadUrl(),attachmentSelect:function(e){var a={filename:e.getParameter("filename")};t.fireAttachmentSelect(a);},attachmentUploadComplete:function(e){var a={response:e.getParameter("response"),uid:t._nextCardUid};t.fireAttachmentUploadComplete(a);this._oAttachmentLink.setHref(t._nextCardAttachmentUrl);this._oAttachmentLink.rerender();},attachmentDelete:function(e){var a={filename:e.getParameter("filename"),uid:t._nextCardUid};t.fireAttachmentDelete(a);},attachmentClick:function(e){var a={filename:e.getParameter("filename"),uid:t._nextCardUid,isCardAttachment:false};t.fireAttachmentClick(a);}});this._spreadTagList();return this._feeder;};sap.suite.ui.commons.NoteTaker.prototype._sortIfNeeded=function(){var b=this.getBinding();if(b==undefined){var c=this.getCards();c.sort(function(C,o){return o.getTimestamp().getTime()-C.getTimestamp().getTime();});this.removeAllCards();for(var i=0;i<c.length;i++){this._carousel.addContent(c[i]);}}};sap.suite.ui.commons.NoteTaker.prototype.getAllTags=function(){var b=this.getBinding("cards");var c=b?this.getCards():this.getNotFilteredCards();var t={};var r=[];for(var i=0;i<c.length;i++){var T=c[i].getTags();for(var j=0;j<T.length;j++){if(T[j]!=""){t[T[j]]=true;}}}for(var a in t){r.push(a);}return r.sort();};sap.suite.ui.commons.NoteTaker.prototype._handleDeleteNote=function(e){var b=this.getBinding("cards");var a={};a.title=e.getParameter("title");a.timestamp=e.getParameter("timestamp");a.body=e.getParameter("body");a.uid=e.getParameter("uid");a.thumbUp=e.getParameter("thumbUp");a.thumbDown=e.getParameter("thumbDown");if(b){this.fireDeleteCard(a);}else{var c=e.getParameter("cardId");var d=this.getNotFilteredCards();for(var i=0;i<d.length;i++){if(d[i].getId()==c){d.splice(i,1);}}this.removeCard(c);this.fireDeleteCard(a);}};sap.suite.ui.commons.NoteTaker.prototype._handleEditNote=function(e){var a={};a.title=e.getParameter("title");a.timestamp=e.getParameter("timestamp");a.body=e.getParameter("body");a.uid=e.getParameter("uid");a.thumbUp=e.getParameter("thumbUp");a.thumbDown=e.getParameter("thumbDown");a.tags=e.getParameter("tags");this.fireEditCard(a);this._sortIfNeeded();this._spreadTagList();};sap.suite.ui.commons.NoteTaker.prototype._addDeleteDelegate=function(c){var t=this;c.attachDeleteNote(function(e){t._handleDeleteNote(e);});};sap.suite.ui.commons.NoteTaker.prototype._addEditDelegate=function(c){var t=this;c.attachEditNote(function(e){t._handleEditNote(e);});};sap.suite.ui.commons.NoteTaker.prototype._handleHomeButton=function(){this._carousel.setFirstVisibleIndex(0);this._feeder._focusDefaultControl();};sap.suite.ui.commons.NoteTaker.prototype.setFilterCriteria=function(f){this.setProperty("filterCriteria",f);this._filter();return this;};sap.suite.ui.commons.NoteTaker.prototype._toggleFilterTagPopup=function(){if(this._bFilterTagPopupOpen){jQuery.sap.byId(this.getId()+"-filterTag-panel").slideToggle();this._bFilterTagPopupOpen=false;}else{this._addTagsToFilterListBox(this.getAllTags());jQuery.sap.byId(this.getId()+"-filterTag-panel").slideToggle();this._oFilterTagList.focus();this._bFilterTagPopupOpen=true;}};sap.suite.ui.commons.NoteTaker.prototype._addTagsToFilterListBox=function(t){var s=[];var f=this._getFilterTags();var l=jQuery.map(t,function(v,i){if(f.indexOf){if(f.indexOf(v)>=0){s.push(i);}}else{for(var k in f){if(f[k]==v){s.push(i);break;}}}return new sap.ui.core.ListItem({text:v});});this._oFilterTagList.setItems(l,true);this._oFilterTagList.setSelectedIndices(s);this._oFilterTagList.rerender();};sap.suite.ui.commons.NoteTaker.prototype._cloneFilterCriteria=function(){var f=this.getFilterCriteria();var n={};if(f){for(var p in f){n[p]=f[p];}}return n;};sap.suite.ui.commons.NoteTaker.prototype._handleFilteringByTags=function(){var f=this._cloneFilterCriteria();var s=this._oFilterTagList.getSelectedItems();var t=[];for(var i in s){t.push(s[i].getText());}f.tags=t;this.setFilterCriteria(f);};sap.suite.ui.commons.NoteTaker.prototype._handleFilteringByThumbUp=function(){var f=this._cloneFilterCriteria();f.thumbUp=!f.thumbUp;this.setFilterCriteria(f);};sap.suite.ui.commons.NoteTaker.prototype._handleFilteringByThumbDown=function(){var f=this._cloneFilterCriteria();f.thumbDown=!f.thumbDown;this.setFilterCriteria(f);};sap.suite.ui.commons.NoteTaker.prototype._handleResetFilters=function(){var f=this.getFilterCriteria();var n=null;if(f&&f.search&&f.search.length>0){n={};n.search=f.search;}this.setFilterCriteria(n);};sap.suite.ui.commons.NoteTaker.prototype._handleSearchingByText=function(s){var f=this._cloneFilterCriteria();var S=[];var n=s.split(new RegExp("\\s+"));for(var i=0;i<n.length;i++){if(n[i].length>0){S.push(n[i]);}}f.search=S;this.setFilterCriteria(f);};sap.suite.ui.commons.NoteTaker.prototype._adjustFilterTagButton=function(){var f=this._getFilterTags();if(f.length){this._oFilterTagButton.setTooltip(this._rb.getText("NOTETAKER_BUTTON_FILTER_TAG_APPLY_SELECTED_TOOLTIP")+": "+f.join(" "));this._oFilterTagButton.addStyleClass("sapSuiteUiCommonsNoteTakerFilterButtonSelected");}else{this._oFilterTagButton.setTooltip(this._rb.getText("NOTETAKER_BUTTON_FILTER_TAG_TOOLTIP"));this._oFilterTagButton.removeStyleClass("sapSuiteUiCommonsNoteTakerFilterButtonSelected");}};sap.suite.ui.commons.NoteTaker.prototype._handleSearchPopup=function(){if(this._bSearchPopupOpen){jQuery.sap.byId(this.getId()+"-search-panel").slideToggle();this._bSearchPopupOpen=false;}else{var p=jQuery.sap.byId(this.getId()+"-filter-search-button").position();jQuery.sap.byId(this.getId()+"-search-panel").css("right",p.right-20).slideToggle();this._oFilterSearchField.focus();this._bSearchPopupOpen=true;}};sap.suite.ui.commons.NoteTaker.prototype._adjustSearchButton=function(){var s=this._oFilterSearchField.getValue();if(s.length){this._oSearchButton.setTooltip(this._rb.getText("NOTETAKER_BUTTON_SEARCHED_BY_TOOLTIP")+": "+s);this._oFilterSearchField.setTooltip(this._rb.getText("NOTETAKER_BUTTON_SEARCHED_BY_TOOLTIP")+": "+s);this._oSearchButton.addStyleClass("sapSuiteUiCommonsNoteTakerFilterButtonSelected");}else{this._oSearchButton.setTooltip(this._rb.getText("NOTETAKER_BUTTON_SEARCH_TOOLTIP"));this._oFilterSearchField.setTooltip(this._rb.getText("NOTETAKER_BUTTON_SEARCH_TOOLTIP"));this._oSearchButton.removeStyleClass("sapSuiteUiCommonsNoteTakerFilterButtonSelected");}};sap.suite.ui.commons.NoteTaker.prototype._getFilterTags=function(){var f=this.getFilterCriteria();if(f&&f.tags&&f.tags.length){return f.tags;}else{return[];}};sap.suite.ui.commons.NoteTaker.prototype._adjustPopupState=function(){var t=jQuery.sap.byId(this.getId()+"-filterTag-button").position();jQuery.sap.byId(this.getId()+"-filterTag-panel").css("left",t.left-20);if(this._bFilterTagPopupOpen){jQuery.sap.byId(this.getId()+"-filterTag-panel").show();}if(this._bSearchPopupOpen){jQuery.sap.byId(this.getId()+"-search-panel").show();}};sap.suite.ui.commons.NoteTaker.prototype._adjustFilteringButtonsStyle=function(){this._adjustFilterTagButton();this._adjustFilteringByThumbUpButtonStyle();this._adjustFilteringByThumbDownButtonStyle();this._adjustSearchButton();};sap.suite.ui.commons.NoteTaker.prototype._adjustFilteringByThumbUpButtonStyle=function(){if(this.getFilterCriteria()&&this.getFilterCriteria().thumbUp){this._oFilterThumbUpButton.addStyleClass("sapSuiteUiCommonsNoteTakerFilterButtonSelected");}else{this._oFilterThumbUpButton.removeStyleClass("sapSuiteUiCommonsNoteTakerFilterButtonSelected");}};sap.suite.ui.commons.NoteTaker.prototype._adjustFilteringByThumbDownButtonStyle=function(){if(this.getFilterCriteria()&&this.getFilterCriteria().thumbDown){this._oFilterThumbDownButton.addStyleClass("sapSuiteUiCommonsNoteTakerFilterButtonSelected");}else{this._oFilterThumbDownButton.removeStyleClass("sapSuiteUiCommonsNoteTakerFilterButtonSelected");}};sap.suite.ui.commons.NoteTaker.prototype.getNotFilteredCards=function(){if(!this._notFilteredCards){this._notFilteredCards=[];}return this._notFilteredCards;};sap.suite.ui.commons.NoteTaker.prototype._spreadTagList=function(){var a=this.getAllTags();this._feeder.setTags(a);var c=this.getCards();for(var i=0;i<c.length;i++){c[i].setAllTags(a);}};sap.suite.ui.commons.NoteTaker.prototype._filter=function(){var b=this.getBinding("cards");var c;var i;if(b){var m=this.getModel().oData['cards'];for(i=0;i<m.length;i++){c=m[i];c.isFiltered=this._applyFilters(c);}this.getModel().updateBindings();b.filter([new sap.ui.model.Filter("isFiltered",sap.ui.model.FilterOperator.EQ,false)]);}else{var n=this.getNotFilteredCards();var v=this.getCards();if(n.length==0&&v.length>0){this.setNotFilteredCards(v);n=v;}for(i=0;i<n.length;i++){c=n[i];c.setIsFiltered(this._applyFilters(c));if(c.getIsFiltered()){this.removeCard(c);}else if(this.indexOfCard(c)<0){this.addCard(c);}}}};sap.suite.ui.commons.NoteTaker.prototype._applyFilters=function(c){var f=true;if(this.getFilterCriteria()){for(var i=0;(i<this._filters.length)&&f;i++){var F=this._filters[i];f=F.call(this,c);}}return!f;};sap.suite.ui.commons.NoteTaker.prototype._validateCardByThumbsFilter=function(c){if(c.getThumbUp&&c.getThumbDown){return this._applyThumbsFilter(c.getThumbUp(),c.getThumbDown());}else{return this._applyThumbsFilter(c.thumbUp,c.thumbDown);}};sap.suite.ui.commons.NoteTaker.prototype._validateCardByTagsFilter=function(c){if(c.getTags){return this._applyTagsFilter(c.getTags());}else{return this._applyTagsFilter(c.tags);}};sap.suite.ui.commons.NoteTaker.prototype._validateCardByTextSearch=function(c){if(c.getBody){return this._applyTextSearch(c.getBody(),c.getHeader());}else{return this._applyTextSearch(c.body,c.header);}};sap.suite.ui.commons.NoteTaker.prototype._applyThumbsFilter=function(t,T){var r=true;var f=this.getFilterCriteria();if(f.thumbUp&&f.thumbDown){r=t||T;}else if(f.thumbUp){r=t;}else if(f.thumbDown){r=T;}return r;};sap.suite.ui.commons.NoteTaker.prototype._applyTagsFilter=function(t){var r=true;var f=this.getFilterCriteria();if(f.tags&&f.tags.length>0){var i,j;var T=f.tags;r=false;for(i=0;i<T.length&&!r;i++){for(j=0;t&&(j<t.length);j++){if(T[i]==t[j]){r=true;break;}}}}return r;};sap.suite.ui.commons.NoteTaker.prototype._applyTextSearch=function(b,h){var r=true;var f=this.getFilterCriteria();if(f.search&&f.search.length>0){var s=f.search;r=false;b=b.toLowerCase();h=h?h.toLowerCase():null;for(var i=0;i<s.length;i++){var w=s[i].toLowerCase();if((b.indexOf(w)>=0)||(h&&h.indexOf(w)>=0)){r=true;break;}}}return r;};sap.suite.ui.commons.NoteTaker.prototype.setAttachmentUploadUrl=function(u){this.setProperty("attachmentUploadUrl",u,true);this._feeder.setAttachmentUploadUrl(u);return this;};sap.suite.ui.commons.NoteTaker.prototype._filters=[sap.suite.ui.commons.NoteTaker.prototype._validateCardByThumbsFilter,sap.suite.ui.commons.NoteTaker.prototype._validateCardByTagsFilter,sap.suite.ui.commons.NoteTaker.prototype._validateCardByTextSearch];sap.suite.ui.commons.NoteTaker.prototype.setNextCardUid=function(u){this._nextCardUid=u;return this;};sap.suite.ui.commons.NoteTaker.prototype._addAttachmentDelegate=function(c){var t=this;c.attachAttachmentClick(function(e){t._handleCardAttachmentClick(e);});};sap.suite.ui.commons.NoteTaker.prototype._handleCardAttachmentClick=function(e){var a={filename:e.getParameter("filename"),uid:e.getParameter("uid"),isCardAttachment:true};this.fireAttachmentClick(a);};sap.suite.ui.commons.NoteTaker.prototype.uploadAttachment=function(){this._feeder._oFileUploader.upload();};sap.suite.ui.commons.NoteTaker.prototype.setAttachmentData=function(a){this._feeder._oFileUploader.setAdditionalData(a);return this;};sap.suite.ui.commons.NoteTaker.prototype.handleAttachmentUploadFail=function(){this._feeder._handleDeleteAttachUI();return this;};sap.suite.ui.commons.NoteTaker.prototype.setNextCardAttachmentUrl=function(u){this._nextCardAttachmentUrl=u;return this;};sap.suite.ui.commons.NoteTaker.prototype.onkeyup=function(e){if(e.which==jQuery.sap.KeyCodes.ESCAPE){if(this._feeder._bTagPopupOpen){this._feeder._toggleTagPopup();this._feeder._oTagButton.focus();}if(this._bFilterTagPopupOpen){this._toggleFilterTagPopup();this._oFilterTagButton.focus();}}}}());
